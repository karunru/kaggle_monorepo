# タスク完了時のワークフロー

## 基本的なワークフロー（CLAUDE.md準拠）

### 1. タスク計画とドキュメント作成
- ユーザの依頼に対する計画を`outputs/claude/`にMarkdown形式で作成
- タスクを適切な粒度（テスト可能な単位）で分割
- **重要**: 計画はユーザの指示範囲内のみで作成（範囲外実装は禁止）

### 2. 実装フェーズ
- 計画に従ってタスクを順次実装
- 各タスク完了時に必ずテストコードを作成
- スコープ外の実装は絶対に行わない

### 3. 品質チェック（必須実行）
タスク実装完了後、以下を**必ず**実行：

```bash
# 1. コードフォーマット
mise run format

# 2. リントチェック（自動修正）
mise run lint

# 3. 型チェック
mise run type-check

# 4. テスト実行
mise run test
```

### 4. エラー処理ルール
- **3回以上**静的解析またはテストが失敗した場合
  → ユーザに報告して実装を中止
- エラーが継続する場合は段階的にデバッグ

### 5. 成果物ドキュメント更新
- 1.で作成したドキュメントに成果物を記録
- ファイル名と内容の概要を明記
- 次のタスクに進む前に完了

## 特別な考慮事項

### Kaggle特有の作業
- データダウンロード: `uv run kaggle competitions download -c competition-name`
- コードアップロード: `mise run update-codes`（実装完了後）
- サブミッション追跡: `mise run track-submission`

### 設定ファイルの場所
- ruff設定: `../../ruff.toml`
- mypy設定: `../../mypy.ini`  
- pytest設定: `../../pytest.ini`
- mise設定: `../../.mise.toml`（ルートレベル）

### テスト実行の注意点
- テストは`tests/`ディレクトリで実行
- `pytest.ini`でpythonpath="src"設定済み
- テストファイルは`test_*.py`形式

### 継続的インテグレーション
プロダクション環境では以下のCIチェックコマンドが実行される：
```bash
mise run ci-format    # フォーマット確認のみ
mise run ci-lint      # リント確認のみ  
mise run ci-type-check # 型チェック確認のみ
```

## トラブルシューティング
- 設定ファイルが見つからない場合は相対パス（`../../`）を確認
- 実験ディレクトリからの実行が前提
- GPU関連エラーの場合は`nvidia-smi`で状況確認