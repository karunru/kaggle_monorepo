07/21/2025 12:31:45 AM INFO __main__: Starting cross-validation training
07/21/2025 12:31:45 AM INFO __main__: Configuration: {'root': '../../outputs/exp002', 'experiment': {'name': 'exp002_imu_only_squeezeformer', 'description': 'IMU-only Squeezeformer model using PyTorch Lightning', 'tags': ['imu_only', 'squeezeformer', 'pytorch_lightning', 'stratified_group_kfold']}, 'paths': {'experiment_dir': '.', 'output_dir': '../../outputs/exp002'}, 'data': {'root': '../../data', 'train_path': '../../data/train.csv', 'test_path': '../../data/test.csv', 'demographics_train_path': '../../data/train_demographics.csv', 'demographics_test_path': '../../data/test_demographics.csv'}, 'model': {'name': 'cmi_squeezeformer', 'input_dim': 7, 'd_model': 256, 'n_layers': 8, 'n_heads': 8, 'd_ff': 1024, 'num_classes': 18, 'kernel_size': 31, 'dropout': 0.1}, 'training': {'seed': 42, 'batch_size': 128, 'num_workers': 4, 'epochs': 3, 'learning_rate': 0.0003, 'weight_decay': 1e-05, 'early_stopping_patience': 15, 'n_folds': 5, 'scheduler': {'type': 'cosine', 'min_lr': 1e-06, 'factor': 0.5, 'patience': 5}}, 'loss': {'type': 'cmi', 'alpha': 0.5, 'focal_gamma': 2.0, 'focal_alpha': 1.0}, 'val': {'name': 'stratified_group_kfold', 'params': {'n_splits': 5, 'random_state': 42, 'target': 'gesture', 'group': 'subject', 'id': 'sequence_id', 'force_recreate': False}}, 'preprocessing': {'target_sequence_length': 200, 'imu_normalization': 'zscore', 'apply_lowpass_filter': False, 'lowpass_cutoff': 10, 'lowpass_fs': 50, 'lowpass_order': 4}, 'augmentation': {'gaussian_noise': {'probability': 0.3, 'std': 0.01}, 'time_scaling': {'probability': 0.3, 'scale_range': [0.9, 1.1]}, 'partial_masking': {'probability': 0.2, 'mask_length_range': [5, 20], 'mask_ratio': 0.1}}, 'lightning': {'trainer': {'accelerator': 'auto', 'devices': 'auto', 'precision': '16-mixed', 'max_epochs': 3, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'deterministic': False, 'benchmark': True, 'enable_checkpointing': True, 'default_root_dir': '../../outputs/exp002', 'enable_progress_bar': True, 'log_every_n_steps': 50, 'check_val_every_n_epoch': 1, 'val_check_interval': 1.0, 'enable_early_stopping': True}, 'callbacks': {'model_checkpoint': {'monitor': 'val_cmi_score', 'mode': 'max', 'save_top_k': 3, 'save_last': True, 'filename': 'epoch-{epoch:02d}-val_cmi_score-{val_cmi_score:.4f}', 'auto_insert_metric_name': False}, 'early_stopping': {'monitor': 'val_cmi_score', 'mode': 'max', 'patience': 15, 'min_delta': 0.001, 'verbose': True}, 'lr_monitor': {'logging_interval': 'epoch'}, 'rich_progress_bar': {'enable': True}}}, 'logging': {'level': 'INFO', 'log_dir': 'logs', 'log_file': 'exp002.log', 'wandb': {'enabled': False, 'project': 'CMI-Detect-Behavior-with-Sensor-Data', 'name': 'exp002', 'tags': ['exp002', 'imu_only', 'squeezeformer']}}, 'hardware': {'use_mixed_precision': True, 'gradient_clip_norm': 1.0}, 'inference': {'batch_size': 64, 'use_tta': False, 'tta_iterations': 5, 'ensemble_strategy': 'average'}, 'target_gestures': ['Above ear - pull hair', 'Forehead - pull hairline', 'Forehead - scratch', 'Eyebrow - pull hair', 'Eyelash - pull hair', 'Neck - pinch skin', 'Neck - scratch', 'Cheek - pinch skin'], 'non_target_gestures': ['Drink from bottle/cup', 'Glasses on/off', 'Pull air toward your face', 'Pinch knee/leg skin', 'Scratch knee/leg skin', 'Write name on leg', 'Text on phone', 'Feel around in tray and pull out an object', 'Write name in air', 'Wave hello'], 'imu_features': ['acc_x', 'acc_y', 'acc_z', 'rot_w', 'rot_x', 'rot_y', 'rot_z']}
07/21/2025 12:31:45 AM INFO __main__: Starting 5-fold cross validation
07/21/2025 12:31:45 AM INFO __main__: Starting training for fold 0
07/21/2025 12:31:45 AM INFO __main__: Creating data module...
07/21/2025 12:33:32 AM INFO __main__: Starting cross-validation training
07/21/2025 12:33:32 AM INFO __main__: Configuration: {'root': '../../outputs/exp002', 'experiment': {'name': 'exp002_imu_only_squeezeformer', 'description': 'IMU-only Squeezeformer model using PyTorch Lightning', 'tags': ['imu_only', 'squeezeformer', 'pytorch_lightning', 'stratified_group_kfold']}, 'paths': {'experiment_dir': '.', 'output_dir': '../../outputs/exp002'}, 'data': {'root': '../../data', 'train_path': '../../data/train.csv', 'test_path': '../../data/test.csv', 'demographics_train_path': '../../data/train_demographics.csv', 'demographics_test_path': '../../data/test_demographics.csv'}, 'model': {'name': 'cmi_squeezeformer', 'input_dim': 7, 'd_model': 256, 'n_layers': 8, 'n_heads': 8, 'd_ff': 1024, 'num_classes': 18, 'kernel_size': 31, 'dropout': 0.1}, 'training': {'seed': 42, 'batch_size': 128, 'num_workers': 4, 'epochs': 100, 'learning_rate': 0.0003, 'weight_decay': 1e-05, 'early_stopping_patience': 15, 'n_folds': 5, 'scheduler': {'type': 'cosine', 'min_lr': 1e-06, 'factor': 0.5, 'patience': 5}}, 'loss': {'type': 'cmi', 'alpha': 0.5, 'focal_gamma': 2.0, 'focal_alpha': 1.0}, 'val': {'name': 'stratified_group_kfold', 'params': {'n_splits': 5, 'random_state': 42, 'target': 'gesture', 'group': 'subject', 'id': 'sequence_id', 'force_recreate': False}}, 'preprocessing': {'target_sequence_length': 200, 'imu_normalization': 'zscore', 'apply_lowpass_filter': False, 'lowpass_cutoff': 10, 'lowpass_fs': 50, 'lowpass_order': 4}, 'augmentation': {'gaussian_noise': {'probability': 0.3, 'std': 0.01}, 'time_scaling': {'probability': 0.3, 'scale_range': [0.9, 1.1]}, 'partial_masking': {'probability': 0.2, 'mask_length_range': [5, 20], 'mask_ratio': 0.1}}, 'lightning': {'trainer': {'accelerator': 'auto', 'devices': 'auto', 'precision': '16-mixed', 'max_epochs': 100, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'deterministic': False, 'benchmark': True, 'enable_checkpointing': True, 'default_root_dir': '../../outputs/exp002', 'enable_progress_bar': True, 'log_every_n_steps': 50, 'check_val_every_n_epoch': 1, 'val_check_interval': 1.0, 'enable_early_stopping': True}, 'callbacks': {'model_checkpoint': {'monitor': 'val_cmi_score', 'mode': 'max', 'save_top_k': 3, 'save_last': True, 'filename': 'epoch-{epoch:02d}-val_cmi_score-{val_cmi_score:.4f}', 'auto_insert_metric_name': False}, 'early_stopping': {'monitor': 'val_cmi_score', 'mode': 'max', 'patience': 15, 'min_delta': 0.001, 'verbose': True}, 'lr_monitor': {'logging_interval': 'epoch'}, 'rich_progress_bar': {'enable': True}}}, 'logging': {'level': 'INFO', 'log_dir': 'logs', 'log_file': 'exp002.log', 'wandb': {'enabled': True, 'project': 'CMI-Detect-Behavior-with-Sensor-Data', 'name': 'exp002', 'tags': ['exp002', 'imu_only', 'squeezeformer']}}, 'hardware': {'use_mixed_precision': True, 'gradient_clip_norm': 1.0}, 'inference': {'batch_size': 64, 'use_tta': False, 'tta_iterations': 5, 'ensemble_strategy': 'average'}, 'target_gestures': ['Above ear - pull hair', 'Forehead - pull hairline', 'Forehead - scratch', 'Eyebrow - pull hair', 'Eyelash - pull hair', 'Neck - pinch skin', 'Neck - scratch', 'Cheek - pinch skin'], 'non_target_gestures': ['Drink from bottle/cup', 'Glasses on/off', 'Pull air toward your face', 'Pinch knee/leg skin', 'Scratch knee/leg skin', 'Write name on leg', 'Text on phone', 'Feel around in tray and pull out an object', 'Write name in air', 'Wave hello'], 'imu_features': ['acc_x', 'acc_y', 'acc_z', 'rot_w', 'rot_x', 'rot_y', 'rot_z']}
07/21/2025 12:33:32 AM INFO __main__: Starting 5-fold cross validation
07/21/2025 12:33:32 AM INFO __main__: Starting training for fold 0
07/21/2025 12:33:32 AM INFO __main__: Creating data module...
07/21/2025 12:33:36 AM INFO __main__: Creating model...
07/21/2025 12:33:36 AM INFO __main__: Starting trainer.fit() - initializing data loaders...
07/21/2025 12:33:36 AM INFO __main__: Batch size: 128, Num workers: 4
07/21/2025 12:54:12 AM INFO __main__: Training completed
07/21/2025 12:54:12 AM INFO __main__: Loading best model from: ../../outputs/exp002/fold_0/version_0/checkpoints/epoch-72-val_cmi_score-0.7679.ckpt
07/21/2025 12:54:14 AM INFO __main__: Fold 0 results: {'fold': 0, 'val_loss': 1.6145563125610352, 'val_cmi_score': 0.7679197788238525, 'val_multiclass_loss': 3.011640787124634, 'val_binary_loss': 0.21747168898582458, 'best_model_path': '../../outputs/exp002/fold_0/version_0/checkpoints/epoch-72-val_cmi_score-0.7679.ckpt'}
07/21/2025 12:54:14 AM INFO __main__: Starting training for fold 1
07/21/2025 12:54:14 AM INFO __main__: Creating data module...
07/21/2025 12:54:17 AM INFO __main__: Creating model...
07/21/2025 12:54:17 AM INFO __main__: Starting trainer.fit() - initializing data loaders...
07/21/2025 12:54:17 AM INFO __main__: Batch size: 128, Num workers: 4
07/21/2025 01:08:58 AM INFO __main__: Training completed
07/21/2025 01:08:58 AM INFO __main__: Loading best model from: ../../outputs/exp002/fold_1/version_0/checkpoints/epoch-44-val_cmi_score-0.7409.ckpt
07/21/2025 01:09:01 AM INFO __main__: Fold 1 results: {'fold': 1, 'val_loss': 1.3597739934921265, 'val_cmi_score': 0.7408555150032043, 'val_multiclass_loss': 2.316093683242798, 'val_binary_loss': 0.40345388650894165, 'best_model_path': '../../outputs/exp002/fold_1/version_0/checkpoints/epoch-44-val_cmi_score-0.7409.ckpt'}
07/21/2025 01:09:01 AM INFO __main__: Starting training for fold 2
07/21/2025 01:09:01 AM INFO __main__: Creating data module...
07/21/2025 01:09:03 AM INFO __main__: Creating model...
07/21/2025 01:09:03 AM INFO __main__: Starting trainer.fit() - initializing data loaders...
07/21/2025 01:09:03 AM INFO __main__: Batch size: 128, Num workers: 4
07/21/2025 01:22:16 AM INFO __main__: Training completed
07/21/2025 01:22:16 AM INFO __main__: Loading best model from: ../../outputs/exp002/fold_2/version_0/checkpoints/epoch-37-val_cmi_score-0.7656.ckpt
07/21/2025 01:22:19 AM INFO __main__: Fold 2 results: {'fold': 2, 'val_loss': 1.0554511547088623, 'val_cmi_score': 0.7656376957893372, 'val_multiclass_loss': 1.8430980443954468, 'val_binary_loss': 0.26780441403388977, 'best_model_path': '../../outputs/exp002/fold_2/version_0/checkpoints/epoch-37-val_cmi_score-0.7656.ckpt'}
07/21/2025 01:22:19 AM INFO __main__: Starting training for fold 3
07/21/2025 01:22:19 AM INFO __main__: Creating data module...
07/21/2025 01:22:22 AM INFO __main__: Creating model...
07/21/2025 01:22:22 AM INFO __main__: Starting trainer.fit() - initializing data loaders...
07/21/2025 01:22:22 AM INFO __main__: Batch size: 128, Num workers: 4
07/21/2025 01:40:37 AM INFO __main__: Training completed
07/21/2025 01:40:37 AM INFO __main__: Loading best model from: ../../outputs/exp002/fold_3/version_0/checkpoints/epoch-58-val_cmi_score-0.7587.ckpt
07/21/2025 01:40:40 AM INFO __main__: Fold 3 results: {'fold': 3, 'val_loss': 1.5391305685043335, 'val_cmi_score': 0.7587482333183289, 'val_multiclass_loss': 2.807044267654419, 'val_binary_loss': 0.27121686935424805, 'best_model_path': '../../outputs/exp002/fold_3/version_0/checkpoints/epoch-58-val_cmi_score-0.7587.ckpt'}
07/21/2025 01:40:40 AM INFO __main__: Starting training for fold 4
07/21/2025 01:40:40 AM INFO __main__: Creating data module...
07/21/2025 01:40:42 AM INFO __main__: Creating model...
07/21/2025 01:40:43 AM INFO __main__: Starting trainer.fit() - initializing data loaders...
07/21/2025 01:40:43 AM INFO __main__: Batch size: 128, Num workers: 4
07/21/2025 01:52:27 AM INFO __main__: Training completed
07/21/2025 01:52:27 AM INFO __main__: Loading best model from: ../../outputs/exp002/fold_4/version_0/checkpoints/epoch-38-val_cmi_score-0.7639.ckpt
07/21/2025 01:52:30 AM INFO __main__: Fold 4 results: {'fold': 4, 'val_loss': 1.1310960054397583, 'val_cmi_score': 0.7639274001121521, 'val_multiclass_loss': 1.9705337285995483, 'val_binary_loss': 0.2916580140590668, 'best_model_path': '../../outputs/exp002/fold_4/version_0/checkpoints/epoch-38-val_cmi_score-0.7639.ckpt'}
07/21/2025 01:52:30 AM INFO __main__: Cross-validation completed
07/21/2025 01:52:30 AM INFO __main__: Mean CV Loss: 1.3400 ± 0.2191
07/21/2025 01:52:30 AM INFO __main__: Mean CV CMI Score: 0.7594 ± 0.0098
07/21/2025 01:52:30 AM INFO __main__: Results saved to: ../../outputs/exp002/cv_results.csv
07/21/2025 01:52:30 AM INFO __main__: CV results logged to WandB
