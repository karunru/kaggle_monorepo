08/31/2025 12:23:17 PM INFO __main__: Starting cross-validation training
08/31/2025 12:23:17 PM INFO __main__: Configuration: {'experiment': {'exp_num': 'exp055', 'name': 'exp055_mish_bert_integration', 'description': 'Angular acceleration, jerk, snap and rolling window statistics features with polars', 'tags': ['imu_only', 'lstm', 'bigru', 'attention', 'residual_se_cnn', 'human_normalization', 'demographics', 'soft_f1_acls', 'bert', 'tsai', 'randaugment', 'imu_rotation', 'handedness_flip', 'angular_acceleration', 'angular_jerk', 'angular_snap', 'rolling_statistics', 'polars']}, 'paths': {'output_dir': '../../../outputs/exp055'}, 'data': {'root': '../../../data', 'train_path': '../../../data/train.csv', 'test_path': '../../../data/test.csv', 'demographics_train_path': '../../../data/train_demographics.csv', 'demographics_test_path': '../../../data/test_demographics.csv'}, 'demographics': {'enabled': True, 'embedding_dim': 16, 'categorical_embedding_dims': {'adult_child': 2, 'sex': 2, 'handedness': 2}, 'numerical_scaling_method': 'minmax', 'clip_outliers': True, 'age_min': 8.0, 'age_max': 60.0, 'height_min': 130.0, 'height_max': 195.0, 'shoulder_to_wrist_min': 35.0, 'shoulder_to_wrist_max': 75.0, 'elbow_to_wrist_min': 15.0, 'elbow_to_wrist_max': 50.0, 'categorical_features': ['adult_child', 'sex', 'handedness'], 'numerical_features': ['age', 'height_cm', 'shoulder_to_wrist_cm', 'elbow_to_wrist_cm'], 'hn_enabled': False, 'hn_eps': 0.001, 'hn_radius_min_max': (0.15, 0.9), 'hn_features': ['linear_acc_mag_per_h', 'linear_acc_mag_per_rS', 'linear_acc_mag_per_rE', 'acc_over_centripetal_rS', 'acc_over_centripetal_rE', 'alpha_like_rS', 'alpha_like_rE', 'v_over_h', 'v_over_rS', 'v_over_rE']}, 'model': {'name': 'cmi_squeezeformer_bert', 'input_dim': 20, 'd_model': 256, 'n_layers': 8, 'n_heads': 8, 'd_ff': 1024, 'num_classes': 18, 'kernel_size': 31, 'dropout': 0.1, 'lstm_hidden_dim': 128, 'lstm_num_layers': 1, 'lstm_bidirectional': True, 'dense1_dim': 256, 'dense2_dim': 128, 'dense1_dropout': 0.5, 'dense2_dropout': 0.3, 'cnn_block1_out_channels': 64, 'cnn_block2_out_channels': 128, 'cnn_block1_kernel_size': 3, 'cnn_block2_kernel_size': 5, 'cnn_dropout': 0.3, 'gru_dropout': 0.4}, 'training': {'seed': 505, 'batch_size': 128, 'num_workers': 8, 'epochs': 200, 'learning_rate': 0.0003, 'weight_decay': 1e-05, 'gradient_clip_val': 0.5, 'scheduler_type': 'cosine', 'scheduler_min_lr': 1e-06, 'scheduler_factor': 0.5, 'scheduler_patience': 5, 'use_mixed_precision': True, 'accumulate_grad_batches': 1}, 'loss': {'type': 'acls', 'alpha': 0.5, 'focal_gamma': 2.0, 'focal_alpha': 1.0, 'soft_f1_beta': 1.0, 'soft_f1_eps': 1e-06, 'label_smoothing': 0.1, 'nine_class_head_enabled': True, 'nine_class_loss_weight': 0.2, 'kl_weight': 0.1, 'kl_temperature': 1.0, 'auto_weighting': 'none', 'auto_weight_clamp': (-10.0, 10.0), 'uncertainty_init_value': 0.0, 'use_mixup': True}, 'acls': {'label_smoothing_alpha': 0.1, 'mbls_margin': 10.0, 'mbls_alpha': 0.1, 'mbls_schedule': None, 'acls_pos_lambda': 1.0, 'acls_neg_lambda': 0.1, 'acls_alpha': 0.1, 'acls_margin': 10.0}, 'length_grouping': {'enabled': False, 'use_dynamic_padding': False, 'mega_batch_multiplier': 8, 'percentile_max_length': 0.95, 'min_sequence_length': 50, 'max_sequence_length': 500, 'put_longest_first': True, 'fallback_to_fixed_length': True}, 'schedule_free': {'enabled': False, 'optimizer_type': 'RAdamScheduleFree', 'learning_rate_multiplier': 5.0, 'warmup_steps': 1000, 'batch_norm_calibration_steps': 50}, 'val': {'name': 'stratified_group_kfold', 'params': {'n_splits': 5, 'random_state': 505, 'target': 'gesture', 'group': 'subject', 'id': 'sequence_id', 'force_recreate': False}}, 'preprocessing': {'target_sequence_length': 200}, 'augmentation': {'enable_randaugment': True, 'randaugment_n': 2, 'randaugment_m': 6.0, 'randaugment_prob': 0.8, 'add_noise_scale': 0.02, 'mag_scale_range': [0.9, 1.1], 'time_warp_max': 0.2, 'crop_ratio': 0.9, 'mask_ratio': 0.1, 'imu_rotation_angle_range': 0.2, 'handedness_flip_prob': 0.0, 'enable_handedness_flip': False, 'gaussian_noise_prob': 0.0, 'gaussian_noise_std': 0.01, 'time_scaling_prob': 0.0, 'time_scaling_range': [0.9, 1.1], 'partial_masking_prob': 0.0, 'partial_masking_length_range': [5, 20], 'partial_masking_ratio': 0.1}, 'logging': {'wandb_enabled': True, 'wandb_project': 'CMI-Detect-Behavior-with-Sensor-Data', 'wandb_name': 'exp055', 'wandb_tags': ['exp055', 'imu_only', 'lstm', 'bigru', 'attention', 'residual_se_cnn', 'human_normalization', 'demographics', 'soft_f1_acls', 'bert', 'tsai', 'randaugment', 'imu_rotation', 'handedness_flip', 'angular_acceleration', 'angular_jerk', 'angular_snap', 'rolling_statistics', 'polars']}, 'lightning': {'trainer': {'accelerator': 'auto', 'devices': 'auto', 'precision': '16-mixed', 'deterministic': False, 'benchmark': True, 'enable_checkpointing': True, 'log_every_n_steps': 10, 'check_val_every_n_epoch': 1, 'val_check_interval': 1.0}, 'callbacks': {'model_checkpoint': {'monitor': 'val_cmi_score', 'mode': 'max', 'save_top_k': 1, 'save_last': True, 'filename': 'epoch-{epoch:02d}-val_cmi_score-{val_cmi_score:.4f}', 'auto_insert_metric_name': False}, 'early_stopping': {'monitor': 'val_cmi_score', 'mode': 'max', 'patience': 30, 'min_delta': 0.0001, 'verbose': True}, 'lr_monitor': {'logging_interval': 'epoch'}, 'rich_progress_bar': {'enable': False}}}, 'root': '../../../outputs/exp055', 'target_gestures': ['Above ear - pull hair', 'Forehead - pull hairline', 'Forehead - scratch', 'Eyebrow - pull hair', 'Eyelash - pull hair', 'Neck - pinch skin', 'Neck - scratch', 'Cheek - pinch skin'], 'non_target_gestures': ['Drink from bottle/cup', 'Glasses on/off', 'Pull air toward your face', 'Pinch knee/leg skin', 'Scratch knee/leg skin', 'Write name on leg', 'Text on phone', 'Feel around in tray and pull out an object', 'Write name in air', 'Wave hello']}
08/31/2025 12:23:18 PM INFO __main__: Starting training for fold 0
08/31/2025 12:25:09 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 12:30:41 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_0/version_0/checkpoints/epoch-80-val_cmi_score-0.7775.ckpt
08/31/2025 12:30:44 PM INFO __main__: Fold 0 results: {'fold': 0, 'val_loss': 0.9319400191307068, 'val_cmi_score': 0.7774983048439026, 'val_multiclass_loss': 1.1950252056121826, 'val_binary_loss': 0.13637809455394745, 'best_model_path': '../../../outputs/exp055/fold_0/version_0/checkpoints/epoch-80-val_cmi_score-0.7775.ckpt'}
08/31/2025 12:30:44 PM INFO __main__: Starting training for fold 1
08/31/2025 12:32:41 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 12:37:23 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_1/version_0/checkpoints/epoch-70-val_cmi_score-0.7391.ckpt
08/31/2025 12:37:26 PM INFO __main__: Fold 1 results: {'fold': 1, 'val_loss': 1.3125780820846558, 'val_cmi_score': 0.7390650510787964, 'val_multiclass_loss': 1.6819210052490234, 'val_binary_loss': 0.2393711805343628, 'best_model_path': '../../../outputs/exp055/fold_1/version_0/checkpoints/epoch-70-val_cmi_score-0.7391.ckpt'}
08/31/2025 12:37:26 PM INFO __main__: Starting training for fold 2
08/31/2025 12:39:24 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 12:45:08 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_2/version_0/checkpoints/epoch-106-val_cmi_score-0.7714.ckpt
08/31/2025 12:45:11 PM INFO __main__: Fold 2 results: {'fold': 2, 'val_loss': 1.1903131008148193, 'val_cmi_score': 0.7714080810546875, 'val_multiclass_loss': 1.49116849899292, 'val_binary_loss': 0.2366175651550293, 'best_model_path': '../../../outputs/exp055/fold_2/version_0/checkpoints/epoch-106-val_cmi_score-0.7714.ckpt'}
08/31/2025 12:45:11 PM INFO __main__: Starting training for fold 3
08/31/2025 12:47:01 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 12:52:20 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_3/version_0/checkpoints/epoch-91-val_cmi_score-0.7669.ckpt
08/31/2025 12:52:23 PM INFO __main__: Fold 3 results: {'fold': 3, 'val_loss': 1.0902318954467773, 'val_cmi_score': 0.7669041156768799, 'val_multiclass_loss': 1.4032366275787354, 'val_binary_loss': 0.16892734169960022, 'best_model_path': '../../../outputs/exp055/fold_3/version_0/checkpoints/epoch-91-val_cmi_score-0.7669.ckpt'}
08/31/2025 12:52:23 PM INFO __main__: Starting training for fold 4
08/31/2025 12:54:16 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 12:58:26 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_4/version_0/checkpoints/epoch-50-val_cmi_score-0.7614.ckpt
08/31/2025 12:58:29 PM INFO __main__: Fold 4 results: {'fold': 4, 'val_loss': 0.9413651823997498, 'val_cmi_score': 0.7614046335220337, 'val_multiclass_loss': 1.240632176399231, 'val_binary_loss': 0.11801160871982574, 'best_model_path': '../../../outputs/exp055/fold_4/version_0/checkpoints/epoch-50-val_cmi_score-0.7614.ckpt'}
08/31/2025 12:58:29 PM INFO __main__: Cross-validation completed
08/31/2025 12:58:29 PM INFO __main__: Mean CV Loss: 1.0933 ± 0.1460
08/31/2025 12:58:29 PM INFO __main__: Mean CV CMI Score: 0.7633 ± 0.0132
08/31/2025 12:58:29 PM INFO __main__: Results saved to: ../../../outputs/exp055/cv_results.csv
08/31/2025 12:58:29 PM INFO __main__: CV results logged to WandB
08/31/2025 01:00:09 PM INFO __main__: Starting cross-validation training
08/31/2025 01:00:09 PM INFO __main__: Configuration: {'experiment': {'exp_num': 'exp055', 'name': 'exp055_mish_bert_integration', 'description': 'Angular acceleration, jerk, snap and rolling window statistics features with polars', 'tags': ['imu_only', 'lstm', 'bigru', 'attention', 'residual_se_cnn', 'human_normalization', 'demographics', 'soft_f1_acls', 'bert', 'tsai', 'randaugment', 'imu_rotation', 'handedness_flip', 'angular_acceleration', 'angular_jerk', 'angular_snap', 'rolling_statistics', 'polars']}, 'paths': {'output_dir': '../../../outputs/exp055'}, 'data': {'root': '../../../data', 'train_path': '../../../data/train.csv', 'test_path': '../../../data/test.csv', 'demographics_train_path': '../../../data/train_demographics.csv', 'demographics_test_path': '../../../data/test_demographics.csv'}, 'demographics': {'enabled': True, 'embedding_dim': 16, 'categorical_embedding_dims': {'adult_child': 2, 'sex': 2, 'handedness': 2}, 'numerical_scaling_method': 'minmax', 'clip_outliers': True, 'age_min': 8.0, 'age_max': 60.0, 'height_min': 130.0, 'height_max': 195.0, 'shoulder_to_wrist_min': 35.0, 'shoulder_to_wrist_max': 75.0, 'elbow_to_wrist_min': 15.0, 'elbow_to_wrist_max': 50.0, 'categorical_features': ['adult_child', 'sex', 'handedness'], 'numerical_features': ['age', 'height_cm', 'shoulder_to_wrist_cm', 'elbow_to_wrist_cm'], 'hn_enabled': False, 'hn_eps': 0.001, 'hn_radius_min_max': (0.15, 0.9), 'hn_features': ['linear_acc_mag_per_h', 'linear_acc_mag_per_rS', 'linear_acc_mag_per_rE', 'acc_over_centripetal_rS', 'acc_over_centripetal_rE', 'alpha_like_rS', 'alpha_like_rE', 'v_over_h', 'v_over_rS', 'v_over_rE']}, 'model': {'name': 'cmi_squeezeformer_bert', 'input_dim': 20, 'd_model': 256, 'n_layers': 8, 'n_heads': 8, 'd_ff': 1024, 'num_classes': 18, 'kernel_size': 31, 'dropout': 0.1, 'lstm_hidden_dim': 128, 'lstm_num_layers': 1, 'lstm_bidirectional': True, 'dense1_dim': 256, 'dense2_dim': 128, 'dense1_dropout': 0.5, 'dense2_dropout': 0.3, 'cnn_block1_out_channels': 64, 'cnn_block2_out_channels': 128, 'cnn_block1_kernel_size': 3, 'cnn_block2_kernel_size': 5, 'cnn_dropout': 0.3, 'gru_dropout': 0.4}, 'training': {'seed': 42, 'batch_size': 128, 'num_workers': 8, 'epochs': 200, 'learning_rate': 0.0003, 'weight_decay': 1e-05, 'gradient_clip_val': 0.5, 'scheduler_type': 'cosine', 'scheduler_min_lr': 1e-06, 'scheduler_factor': 0.5, 'scheduler_patience': 5, 'use_mixed_precision': True, 'accumulate_grad_batches': 1}, 'loss': {'type': 'acls', 'alpha': 0.5, 'focal_gamma': 2.0, 'focal_alpha': 1.0, 'soft_f1_beta': 1.0, 'soft_f1_eps': 1e-06, 'label_smoothing': 0.1, 'nine_class_head_enabled': True, 'nine_class_loss_weight': 0.2, 'kl_weight': 0.1, 'kl_temperature': 1.0, 'auto_weighting': 'none', 'auto_weight_clamp': (-10.0, 10.0), 'uncertainty_init_value': 0.0, 'use_mixup': True}, 'acls': {'label_smoothing_alpha': 0.1, 'mbls_margin': 10.0, 'mbls_alpha': 0.1, 'mbls_schedule': None, 'acls_pos_lambda': 1.0, 'acls_neg_lambda': 0.1, 'acls_alpha': 0.1, 'acls_margin': 10.0}, 'length_grouping': {'enabled': False, 'use_dynamic_padding': False, 'mega_batch_multiplier': 8, 'percentile_max_length': 0.95, 'min_sequence_length': 50, 'max_sequence_length': 500, 'put_longest_first': True, 'fallback_to_fixed_length': True}, 'schedule_free': {'enabled': False, 'optimizer_type': 'RAdamScheduleFree', 'learning_rate_multiplier': 5.0, 'warmup_steps': 1000, 'batch_norm_calibration_steps': 50}, 'val': {'name': 'stratified_group_kfold', 'params': {'n_splits': 5, 'random_state': 42, 'target': 'gesture', 'group': 'subject', 'id': 'sequence_id', 'force_recreate': False}}, 'preprocessing': {'target_sequence_length': 200}, 'augmentation': {'enable_randaugment': True, 'randaugment_n': 2, 'randaugment_m': 6.0, 'randaugment_prob': 0.8, 'add_noise_scale': 0.02, 'mag_scale_range': [0.9, 1.1], 'time_warp_max': 0.2, 'crop_ratio': 0.9, 'mask_ratio': 0.1, 'imu_rotation_angle_range': 0.2, 'handedness_flip_prob': 0.0, 'enable_handedness_flip': False, 'gaussian_noise_prob': 0.0, 'gaussian_noise_std': 0.01, 'time_scaling_prob': 0.0, 'time_scaling_range': [0.9, 1.1], 'partial_masking_prob': 0.0, 'partial_masking_length_range': [5, 20], 'partial_masking_ratio': 0.1}, 'logging': {'wandb_enabled': True, 'wandb_project': 'CMI-Detect-Behavior-with-Sensor-Data', 'wandb_name': 'exp055', 'wandb_tags': ['exp055', 'imu_only', 'lstm', 'bigru', 'attention', 'residual_se_cnn', 'human_normalization', 'demographics', 'soft_f1_acls', 'bert', 'tsai', 'randaugment', 'imu_rotation', 'handedness_flip', 'angular_acceleration', 'angular_jerk', 'angular_snap', 'rolling_statistics', 'polars']}, 'lightning': {'trainer': {'accelerator': 'auto', 'devices': 'auto', 'precision': '16-mixed', 'deterministic': False, 'benchmark': True, 'enable_checkpointing': True, 'log_every_n_steps': 10, 'check_val_every_n_epoch': 1, 'val_check_interval': 1.0}, 'callbacks': {'model_checkpoint': {'monitor': 'val_cmi_score', 'mode': 'max', 'save_top_k': 1, 'save_last': True, 'filename': 'epoch-{epoch:02d}-val_cmi_score-{val_cmi_score:.4f}', 'auto_insert_metric_name': False}, 'early_stopping': {'monitor': 'val_cmi_score', 'mode': 'max', 'patience': 30, 'min_delta': 0.0001, 'verbose': True}, 'lr_monitor': {'logging_interval': 'epoch'}, 'rich_progress_bar': {'enable': False}}}, 'root': '../../../outputs/exp055', 'target_gestures': ['Above ear - pull hair', 'Forehead - pull hairline', 'Forehead - scratch', 'Eyebrow - pull hair', 'Eyelash - pull hair', 'Neck - pinch skin', 'Neck - scratch', 'Cheek - pinch skin'], 'non_target_gestures': ['Drink from bottle/cup', 'Glasses on/off', 'Pull air toward your face', 'Pinch knee/leg skin', 'Scratch knee/leg skin', 'Write name on leg', 'Text on phone', 'Feel around in tray and pull out an object', 'Write name in air', 'Wave hello']}
08/31/2025 01:00:09 PM INFO __main__: Starting training for fold 0
08/31/2025 01:02:02 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 01:08:07 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_0/version_1/checkpoints/epoch-105-val_cmi_score-0.7728.ckpt
08/31/2025 01:08:09 PM INFO __main__: Fold 0 results: {'fold': 0, 'val_loss': 1.0550758838653564, 'val_cmi_score': 0.7728127837181091, 'val_multiclass_loss': 1.3648231029510498, 'val_binary_loss': 0.15764756500720978, 'best_model_path': '../../../outputs/exp055/fold_0/version_1/checkpoints/epoch-105-val_cmi_score-0.7728.ckpt'}
08/31/2025 01:08:09 PM INFO __main__: Starting training for fold 1
08/31/2025 01:10:01 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 01:16:32 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_1/version_1/checkpoints/epoch-135-val_cmi_score-0.7519.ckpt
08/31/2025 01:16:36 PM INFO __main__: Fold 1 results: {'fold': 1, 'val_loss': 1.5383402109146118, 'val_cmi_score': 0.7518690824508667, 'val_multiclass_loss': 1.9866334199905396, 'val_binary_loss': 0.2806243896484375, 'best_model_path': '../../../outputs/exp055/fold_1/version_1/checkpoints/epoch-135-val_cmi_score-0.7519.ckpt'}
08/31/2025 01:16:36 PM INFO __main__: Starting training for fold 2
08/31/2025 01:18:28 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 01:23:24 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_2/version_1/checkpoints/epoch-74-val_cmi_score-0.7789.ckpt
08/31/2025 01:23:27 PM INFO __main__: Fold 2 results: {'fold': 2, 'val_loss': 1.0201492309570312, 'val_cmi_score': 0.7789462208747864, 'val_multiclass_loss': 1.3131539821624756, 'val_binary_loss': 0.1369209587574005, 'best_model_path': '../../../outputs/exp055/fold_2/version_1/checkpoints/epoch-74-val_cmi_score-0.7789.ckpt'}
08/31/2025 01:23:27 PM INFO __main__: Starting training for fold 3
08/31/2025 01:25:19 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 01:29:46 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_3/version_1/checkpoints/epoch-61-val_cmi_score-0.7650.ckpt
08/31/2025 01:29:50 PM INFO __main__: Fold 3 results: {'fold': 3, 'val_loss': 1.011078953742981, 'val_cmi_score': 0.7649798393249512, 'val_multiclass_loss': 1.2849160432815552, 'val_binary_loss': 0.18328124284744263, 'best_model_path': '../../../outputs/exp055/fold_3/version_1/checkpoints/epoch-61-val_cmi_score-0.7650.ckpt'}
08/31/2025 01:29:50 PM INFO __main__: Starting training for fold 4
08/31/2025 01:31:42 PM INFO __main__: Using input_dim=120 (HN features: False)
08/31/2025 01:37:11 PM INFO __main__: Loading best model from: ../../../outputs/exp055/fold_4/version_1/checkpoints/epoch-98-val_cmi_score-0.7708.ckpt
08/31/2025 01:37:14 PM INFO __main__: Fold 4 results: {'fold': 4, 'val_loss': 1.1832427978515625, 'val_cmi_score': 0.7707607746124268, 'val_multiclass_loss': 1.5320539474487305, 'val_binary_loss': 0.24187813699245453, 'best_model_path': '../../../outputs/exp055/fold_4/version_1/checkpoints/epoch-98-val_cmi_score-0.7708.ckpt'}
08/31/2025 01:37:14 PM INFO __main__: Cross-validation completed
08/31/2025 01:37:14 PM INFO __main__: Mean CV Loss: 1.1616 ± 0.1982
08/31/2025 01:37:14 PM INFO __main__: Mean CV CMI Score: 0.7679 ± 0.0092
08/31/2025 01:37:14 PM INFO __main__: Results saved to: ../../../outputs/exp055/cv_results.csv
08/31/2025 01:37:14 PM INFO __main__: CV results logged to WandB
