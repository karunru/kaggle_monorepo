08/05/2025 06:03:41 PM INFO __main__: Starting cross-validation training
08/05/2025 06:03:41 PM INFO __main__: Configuration: {'experiment': {'name': 'exp008_early_stopping_with_loss', 'description': 'Early stopping with val_loss instead of val_cmi_score', 'tags': ['imu_only', 'squeezeformer', 'pytorch_lightning', 'early_stopping_loss']}, 'paths': {'output_dir': '../../../outputs/exp008'}, 'data': {'root': '../../../data', 'train_path': '../../../data/train.csv', 'test_path': '../../../data/test.csv'}, 'model': {'name': 'cmi_squeezeformer', 'input_dim': 7, 'd_model': 256, 'n_layers': 8, 'n_heads': 8, 'd_ff': 1024, 'num_classes': 18, 'kernel_size': 31, 'dropout': 0.1}, 'training': {'seed': 42, 'batch_size': 128, 'num_workers': 4, 'epochs': 100, 'learning_rate': 0.0003, 'weight_decay': 1e-05, 'gradient_clip_val': 1.0, 'scheduler_type': 'cosine', 'scheduler_min_lr': 1e-06, 'scheduler_factor': 0.5, 'scheduler_patience': 5, 'early_stopping_patience': 15, 'use_mixed_precision': True, 'accumulate_grad_batches': 1}, 'loss': {'type': 'cmi', 'alpha': 0.5, 'focal_gamma': 2.0, 'focal_alpha': 1.0}, 'length_grouping': {'enabled': False, 'use_dynamic_padding': False, 'mega_batch_multiplier': 8, 'percentile_max_length': 0.95, 'min_sequence_length': 50, 'max_sequence_length': 500, 'put_longest_first': True, 'fallback_to_fixed_length': True}, 'schedule_free': {'enabled': False, 'optimizer_type': 'RAdamScheduleFree', 'learning_rate_multiplier': 5.0, 'warmup_steps': 1000, 'batch_norm_calibration_steps': 50}, 'ema': {'enabled': True, 'beta': 0.9999, 'update_after_step': 1000, 'update_every': 10, 'update_model_with_ema_every': 1000, 'use_ema_for_validation': True}, 'val': {'name': 'stratified_group_kfold', 'params': {'n_splits': 5, 'random_state': 42, 'target': 'gesture', 'group': 'subject', 'id': 'sequence_id', 'force_recreate': False}}, 'preprocessing': {'target_sequence_length': 200}, 'augmentation': {'gaussian_noise_prob': 0.3, 'gaussian_noise_std': 0.01, 'time_scaling_prob': 0.3, 'time_scaling_range': [0.9, 1.1], 'partial_masking_prob': 0.2, 'partial_masking_length_range': [5, 20], 'partial_masking_ratio': 0.1}, 'logging': {'wandb_enabled': True, 'wandb_project': 'CMI-Detect-Behavior-with-Sensor-Data', 'wandb_name': 'exp008', 'wandb_tags': ['exp008', 'switch_ema', 'squeezeformer']}, 'lightning': {'trainer': {'accelerator': 'auto', 'devices': 'auto', 'precision': '16-mixed', 'deterministic': False, 'benchmark': True, 'enable_checkpointing': True, 'log_every_n_steps': 10, 'check_val_every_n_epoch': 1, 'val_check_interval': 1.0}, 'callbacks': {'model_checkpoint': {'monitor': 'val_loss', 'mode': 'min', 'save_top_k': 1, 'save_last': True, 'filename': 'epoch-{epoch:02d}-val_loss-{val_loss:.4f}', 'auto_insert_metric_name': False}, 'early_stopping': {'monitor': 'val_loss', 'mode': 'min', 'min_delta': 0.001, 'verbose': True}, 'lr_monitor': {'logging_interval': 'epoch'}, 'rich_progress_bar': {'enable': False}}}, 'root': '../../../outputs/exp008', 'target_gestures': ['Above ear - pull hair', 'Forehead - pull hairline', 'Forehead - scratch', 'Eyebrow - pull hair', 'Eyelash - pull hair', 'Neck - pinch skin', 'Neck - scratch', 'Cheek - pinch skin'], 'non_target_gestures': ['Drink from bottle/cup', 'Glasses on/off', 'Pull air toward your face', 'Pinch knee/leg skin', 'Scratch knee/leg skin', 'Write name on leg', 'Text on phone', 'Feel around in tray and pull out an object', 'Write name in air', 'Wave hello'], 'imu_features': ['acc_x', 'acc_y', 'acc_z', 'rot_w', 'rot_x', 'rot_y', 'rot_z']}
08/05/2025 06:03:41 PM INFO __main__: Starting training for fold 0
08/05/2025 06:11:36 PM INFO __main__: Loading best model from: ../../../outputs/exp008/fold_0/version_0/checkpoints/epoch-16-val_loss-0.8145.ckpt
08/05/2025 06:11:38 PM INFO __main__: Fold 0 results: {'fold': 0, 'val_loss': 0.8145167231559753, 'val_cmi_score': 0.7191700339317322, 'val_multiclass_loss': 1.454227089881897, 'val_binary_loss': 0.17480617761611938, 'best_model_path': '../../../outputs/exp008/fold_0/version_0/checkpoints/epoch-16-val_loss-0.8145.ckpt'}
08/05/2025 06:11:38 PM INFO __main__: Starting training for fold 1
08/05/2025 06:17:45 PM INFO __main__: Loading best model from: ../../../outputs/exp008/fold_1/version_0/checkpoints/epoch-13-val_loss-0.9417.ckpt
08/05/2025 06:17:47 PM INFO __main__: Fold 1 results: {'fold': 1, 'val_loss': 0.9416740536689758, 'val_cmi_score': 0.7029606103897095, 'val_multiclass_loss': 1.6394606828689575, 'val_binary_loss': 0.24388740956783295, 'best_model_path': '../../../outputs/exp008/fold_1/version_0/checkpoints/epoch-13-val_loss-0.9417.ckpt'}
08/05/2025 06:17:47 PM INFO __main__: Starting training for fold 2
08/05/2025 06:25:01 PM INFO __main__: Loading best model from: ../../../outputs/exp008/fold_2/version_0/checkpoints/epoch-11-val_loss-0.8296.ckpt
08/05/2025 06:25:04 PM INFO __main__: Fold 2 results: {'fold': 2, 'val_loss': 0.8295718431472778, 'val_cmi_score': 0.7144949436187744, 'val_multiclass_loss': 1.461847186088562, 'val_binary_loss': 0.19729679822921753, 'best_model_path': '../../../outputs/exp008/fold_2/version_0/checkpoints/epoch-11-val_loss-0.8296.ckpt'}
08/05/2025 06:25:04 PM INFO __main__: Starting training for fold 3
08/05/2025 06:32:13 PM INFO __main__: Loading best model from: ../../../outputs/exp008/fold_3/version_0/checkpoints/epoch-14-val_loss-0.8479.ckpt
08/05/2025 06:32:16 PM INFO __main__: Fold 3 results: {'fold': 3, 'val_loss': 0.8479434847831726, 'val_cmi_score': 0.7394230961799622, 'val_multiclass_loss': 1.5095088481903076, 'val_binary_loss': 0.18637803196907043, 'best_model_path': '../../../outputs/exp008/fold_3/version_0/checkpoints/epoch-14-val_loss-0.8479.ckpt'}
08/05/2025 06:32:16 PM INFO __main__: Starting training for fold 4
08/05/2025 06:39:39 PM INFO __main__: Loading best model from: ../../../outputs/exp008/fold_4/version_0/checkpoints/epoch-14-val_loss-0.7698.ckpt
08/05/2025 06:39:42 PM INFO __main__: Fold 4 results: {'fold': 4, 'val_loss': 0.7697959542274475, 'val_cmi_score': 0.7374135851860046, 'val_multiclass_loss': 1.3972009420394897, 'val_binary_loss': 0.14239095151424408, 'best_model_path': '../../../outputs/exp008/fold_4/version_0/checkpoints/epoch-14-val_loss-0.7698.ckpt'}
08/05/2025 06:39:42 PM INFO __main__: Cross-validation completed
08/05/2025 06:39:42 PM INFO __main__: Mean CV Loss: 0.8407 ± 0.0567
08/05/2025 06:39:42 PM INFO __main__: Mean CV CMI Score: 0.7227 ± 0.0139
08/05/2025 06:39:42 PM INFO __main__: Results saved to: ../../../outputs/exp008/cv_results.csv
08/05/2025 06:39:42 PM INFO __main__: CV results logged to WandB
