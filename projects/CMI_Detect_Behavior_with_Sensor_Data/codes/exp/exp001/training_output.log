ðŸš€ Starting CMI Sensor Data Training
Configuration:
paths:
  experiment_dir: .
data:
  root: ../../data
  train_path: ../../data/train.csv
  test_path: ../../data/test.csv
  demographics_train_path: ../../data/train_demographics.csv
  demographics_test_path: ../../data/test_demographics.csv
model:
  name: squeezeformer
  d_model: 256
  n_layers: 8
  n_heads: 8
  d_ff: 1024
  dropout: 0.1
  kernel_size: 31
training:
  seed: 42
  batch_size: 32
  num_workers: 4
  epochs: 100
  learning_rate: 0.0003
  weight_decay: 1.0e-05
  early_stopping_patience: 15
  n_folds: 5
  output_dir: ../../outputs/exp001
  scheduler:
    type: cosine
    min_lr: 1.0e-06
    factor: 0.5
    patience: 5
loss:
  type: cmi
  alpha: 0.5
  use_class_weights: true
  label_smoothing: 0.1
  focal_gamma: 2.0
  focal_alpha: 1.0
  consistency_weight: 0.1
val:
  name: stratified_group_kfold
  params:
    n_splits: 5
    random_state: 42
    target: gesture
    group: subject
    id: sequence_id
    force_recreate: false
preprocessing:
  target_sequence_length: 200
  transition_length: 100
  gesture_length: 100
  imu_normalization: zscore
  thermopile_normalization: minmax
  tof_normalization: minmax
  apply_lowpass_filter: true
  lowpass_cutoff: 10
  lowpass_fs: 50
  lowpass_order: 4
  add_magnitude_features: true
  add_statistical_features: true
  add_tof_spatial_features: true
augmentation:
  gaussian_noise:
    probability: 0.3
    std: 0.01
  time_scaling:
    probability: 0.3
    scale_range:
    - 0.9
    - 1.1
  partial_masking:
    probability: 0.2
    mask_length_range:
    - 5
    - 20
    mask_ratio: 0.1
logging:
  level: INFO
  log_dir: logs
  log_file: exp001.log
experiment:
  name: exp001_squeezeformer_baseline
  description: Baseline Squeezeformer model with standard preprocessing and augmentation
  tags:
  - baseline
  - squeezeformer
  - multimodal
  - sensor_fusion
hardware:
  use_mixed_precision: true
  gradient_clip_norm: 1.0
inference:
  batch_size: 64
  use_tta: false
  tta_iterations: 5
  ensemble_strategy: average
target_gestures:
- Above ear - pull hair
- Forehead - pull hairline
- Forehead - scratch
- Eyebrow - pull hair
- Eyelash - pull hair
- Neck - pinch skin
- Neck - scratch
- Cheek - pinch skin
non_target_gestures:
- Drink from bottle/cup
- Glasses on/off
- Pull air toward your face
- Pinch knee/leg skin
- Scratch knee/leg skin
- Write name on leg
- Text on phone
- Feel around in tray and pull out an object
- Write name in air
- Wave hello

Using device: cuda
ðŸ“‚ Loading data...
Loaded 574945 training samples
ðŸ”§ Preprocessing data...
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/karunru/Home/Kaggle/kaggle_monorepo/projects/CMI_Detect_Behavior_with_Sensor_Data/exp/exp001/train.py", line 310, in main
    sequences, labels, subjects = process_sequences(train_df, preprocessor)
                                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/karunru/Home/Kaggle/kaggle_monorepo/projects/CMI_Detect_Behavior_with_Sensor_Data/src/preprocessor.py", line 213, in process_sequences
    full_sequence = np.concatenate([transition_resampled, gesture_resampled], axis=0)
ValueError: all the input array dimensions except for the concatenation axis must match exactly, but along dimension 1, the array at index 0 has size 349 and the array at index 1 has size 341

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
