seed: &seed 1031
log_path: ./log/
config_path: ./config/
weight_path: ./weights/
pred_path: ./preds/
data_path: ../data/
root: ./preds/

datamodule: BirdCLEFDataModule

n_splits: &n_splits 5
epoch: 20

trainer:
  accumulate_grad_batches: 8
  fast_dev_run: False
  precision: bf16-mixed
  detect_anomaly: True

transform:
  name: get_default_transforms
  size: 256,256

strong_transform:
  name: resizemix
  params:
    alpha: 0.1
    beta: 0.5

train_loader:
  batch_size: 200
  shuffle: True
  num_workers: 8
  pin_memory: True
  drop_last: True

val_loader:
  batch_size: 200
  shuffle: False
  num_workers: 8
  pin_memory: True
  drop_last: False

model:
  name: Model
  backbone: convnextv2_tiny.fcmae_ft_in22k_in1k_384
  pool_type: avgmax
  in_chans: 1
  output_dim: 206

train_folds:
  - 0
  - 1
  - 2
  - 3
  - 4

TTA: False

# RAdamScheduleFree optimizer configuration
optimizer:
  opt: radam_schedule_free
  lr: 0.0025  # Default learning rate for RAdamScheduleFree
  weight_decay: 0.01
  betas: [0.9, 0.999]
  eps: 1e-8
  r: 0.0  # Warmup parameter
  weight_lr_power: 2.0
  foreach: true

# No scheduler needed for schedule-free optimizer
scheduler:
  sched: none
  num_epochs: 100
  min_lr: 1e-4
  warmup_epochs: 0
  warmup_lr: 1e-4
  warmup_prefix: false

loss:
  name: nn.BCEWithLogitsLoss
  params:
    reduction: mean

early_stopping:
  patience: 4

stochastic_weight_avg:
  swa_lrs: 1e-4
  swa_epoch_start: 3
  annealing_epochs: 5


val:
  name: stratified_kfold
  params:
    id: filename
    target: primary_label
    n_splits: *n_splits
    random_state: *seed
    force_recreate: False

sampling:
  #  name: random_over_sample
  name: none
  params:
    random_state: *seed
